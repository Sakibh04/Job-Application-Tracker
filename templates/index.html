<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Application Tracker - Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div>
                    <h1 class="job-tracker">Job Tracker</h1>
                </div>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="logout()">Logout</button>
                </div>
            </div>
            <div class="stats">
                <div class="stat-item">
                    <span class="stat-number" id="totalApps">0</span>
                    <span>Total Applications</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="interviewCount">0</span>
                    <span>Interviews</span>
                </div>
            </div>
        </div>

        <div class="controls">
            <div class="control-group">
                <button class="btn btn-primary" onclick="openModal()">+ Add New Application</button>
                <button class="btn btn-success" onclick="exportToCSV()">Export CSV</button>
            </div>
            <div class="filters">
                <select id="statusFilter" onchange="loadJobs()">
                    <option value="">All Statuses</option>
                    <option value="applied">Applied</option>
                    <option value="interview">Interview</option>
                    <option value="offer">Offer</option>
                    <option value="rejected">Rejected</option>
                    <option value="withdrawn">Withdrawn</option>
                </select>
                <button class="btn btn-outline" onclick="clearFilters()">Clear Filters</button>
            </div>
        </div>

        <div class="loading" id="loading" style="display: none;">
            <div class="spinner"></div>
            <p>Loading...</p>
        </div>

        <div class="table-container">
            <table id="jobTable">
                <thead>
                    <tr>
                        <th onclick="sortTable('company')">Company</th>
                        <th onclick="sortTable('position')">Position</th>
                        <th onclick="sortTable('status')">Status</th>
                        <th onclick="sortTable('applied_date')">Applied Date</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="jobTableBody">
                </tbody>
            </table>
            <div id="emptyState" class="empty-state" style="display: none;">
                <h3>No applications found!</h3>
                <p>Click "Add New Application" to get started tracking your job search.</p>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div id="jobModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Add New Application</h2>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>
            <form id="jobForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="company">Company *</label>
                        <input type="text" id="company" required>
                    </div>
                    <div class="form-group">
                        <label for="position">Position *</label>
                        <input type="text" id="position" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="status">Status</label>
                        <select id="status">
                            <option value="applied">Applied</option>
                            <option value="interview">Interview</option>
                            <option value="offer">Offer</option>
                            <option value="rejected">Rejected</option>
                            <option value="withdrawn">Withdrawn</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="appliedDate">Applied Date</label>
                    <input type="date" id="appliedDate">
                </div>
                
                <div class="form-group">
                    <label for="jobUrl">Job URL</label>
                    <input type="url" id="jobUrl" placeholder="https://...">
                </div>
                
                <div class="form-group">
                    <label for="salary">Salary Range</label>
                    <input type="text" id="salary" placeholder="$50,000 - $70,000">
                </div>
                
                <div class="form-group">
                    <label for="notes">Notes</label>
                    <textarea id="notes" placeholder="Interview notes, application details, etc..." rows="4"></textarea>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="saveButton">
                        <span class="btn-text">Save Application</span>
                        <span class="btn-loading" style="display: none;">Saving...</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>